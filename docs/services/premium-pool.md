# Premium Pool

Premium Pool - это сервис, позволяющий контент-провайдерам публиковать свой контент в Сети и подключаться к децентрализованному биллингу.

Основой сервиса является понятие премиум пул - это объединение одного либо более контент-провайдеров, которое характеризуется общими условиями биллинга. С технической точки зрения премиум пул - это сущность в блокчейне с такими свойствами:

- список владельцев пула
- настройки биллинга

Настройки пула могут быть изменены только путем голосования его владельцев.

К каждому пулу привязан отдельный токен, который используется для оплаты доступа к контенту в рамках пула. Эмиссия этих токенов выполняется во время создания пула.


## Создание пула

Создать пул может любой участник Сети. Для этого необходимо:

- заплатить Сети комиссию в 1000 XAT
- сделать эмиссию токенов для данного пула (30% выпущенных токенов - комиссия Сети)

Описанные действия выполняются операцией [Create Premium Pool][1]. В результате выполнения этой операции создается специальный аккаунт, который является представлением пула в блокчейне. Настройки пула хранятся в data entry этого аккаунта. Владельцами пула являются подписанты этого аккаунта.

Исключением является [Системный пул][2] - это открытый пул, владельцем которого является сама Сеть.


## Типы пулов

Есть два типа пулов - открытый и закрытый.

К открытому пулу может подключиться любой бродкастер без необходимости согласования с владельцами пула. Для этого необходимо указать в [транспортном файле][3] идентификатор пула (его публичный ключ).

Для подключения к закрытому пулу бродкастер должен быть добавлен в список участников. Сделать это могут только владельцы пула.

Тип пула указывается при его создании и не может быть изменен впоследствии.


## Системный пул

Системный пул - это открытый пул, вдалельцем которого является вся Сеть.

Настройки Системного пула хранятся в системной настройке `system_premium_pool_settings`. Соответственно, изменять настройки Системного пула можно путем [изменения системных настроек][4].

В отличие от обычных премиум пулов, настройки биллинга Системного пула можно изменять.

Для оплаты доступа в рамках Системного пула используются системные токены.


## Владельцы пула и участники пула

Владельцы пула - это аккаунты, у которых есть право изменять настройки пула, в том числе список владельцев и список участников (для закрытого пула). Владельцам пула изначательно принадлежат все токены, которые выпускаются в процессе создания пула.

Владельцем Системного пула является вся Сеть в целом.

Участники пула - это бродкастеры, подключенные к пулу. Для закрытых пулов - это список аккаунтов бродкастеров, хранящийся в настройках пула. Изменять список участников закрытого пула могут только владельцы пула. Участником открытого пула может стать любой бродкастер.


## Распределение доходов

Средства от продажи доступа к контенту в пуле распределяются по такой схеме:

- 30% - комиссия системы (это значение хранится в [системных настройках][4])
- 70% - доля бродкастеров

В случае разового доступа и поминутной тарификации бродкастер получает свою долю напрямую.

Детали распределения средств от подписок между бродкастерами описаны ниже в разделе [Биллинг][10].


## Настройки пула

В настройках пула хранится такая информация:

- тип пула (открытый или закрытый)
- кто оплачивает трафик (бродкастеры либо пользователи)
- настройки биллинга:
    - стоимость разового доступа
    - стоимость минуты для поминутной тарификации
    - стоимость и длительность подписки

Настройки биллинга позволяют включать либо выключать определенные типы биллинга, а также создавать несколько вариантов доступа (в зависимости от длительности). Например, можно запретить разовый доступ и поминутную тарификацию и сделать два варианта подписки: на 30 и на 360 дней.

Стоимость доступа может зависеть от страны, что тоже можно указать в настройках биллинга.

Тип пула и настройки биллинга указываются при создании пула и не могут быть изменены впоследствии. Если возникает необходимость изменить условия доступа к контенту, нужно создать новый премиум пул с новыми настройками.

Настройки биллинга применяются ко всему контенту, подключенному к пулу.


## Биллинг

### Подписка

Подписка предоставляет доступ к контенту в рамках пула на фиксированный период времени (например, на 30 дней). Доступ по подписке ограничен временем просмотра - не более 1000 минут в месяц.

Покупка подписки осуществляется операцией [Buy Subscription][5].

Подписка активируется в момент покупки.

Распределение средств от оплаты подписок осуществляется операцией [Distribute Subscriptions][6]. Доля бродкастеров распределяется между бродкастерами, контент которых смотрел пользователь подписки, пропорционально времени просмотра. Детали алгоритма распределения смотрите в описании операции.


### Поминутная тарификация

Предусматривает оплату за каждую минуту просмотра контента. Средства списываются со счета для оплаты сервисов. Распределение средств выполняется в момент списания.

Списание и распределение средств осуществляется блокчейном второго уровня в рамках системы [учета трафика и времени][7].


### Разовый доступ

Предоставляет доступ к одной конкретной единице контента.

Логика работы разового доступа зависит от типа контента:

- VOD - доступ предоставляется навсегда
- Live - доступ предоставляется на фиксированное время (это время указано в настройках биллинга)

Покупка разового доступа осуществляется операцией [Buy Single Access][8]. Эта же операция выполняет распределение средств.

Разовый доступ активируется в момент покупки.


## Оплата трафика

В настройках премиум пула есть возможность выбора стороны, оплачивающей трафик: пользователи либо бродкастеры.

Если трафик оплачивают пользователи, то расчеты за трафик выполняются по обычной схеме (точно так же, как для контента, не входящего в премиум пул).

Оплата трафика бродкастерами выполняется по такой схеме:

- весь трафик оплачивается со специального счета бродкастера
- узлы, потребляющие трафик, ничего не платят
- узлы, отдающие трафик, могут получить вознаграждение по системе "лотерея" (подробное описание [здесь][9])


## Контроль доступа к контенту

Контроль доступа полностью децентрализован и осуществляется узлами сети при обмене данными между собой. Каждый узел, участвующий в передаче данных по контенту из премиум пула, перед передачей данных другому узлу проверяет наличие у него доступа к данному контенту согласно настройкам пула.

[1]: ../list-of-operations/create-premium-pool.md
[2]: #_3
[3]: ../glossary/transport-file.md
[4]: ../glossary/system-settings.md
[5]: ../list-of-operations/buy-subscription.md
[6]: ../list-of-operations/distribute-subscriptions.md
[7]: ../get-started/traffic-time-accounting.md
[8]: ../list-of-operations/buy-single-access.md
[9]: ../traffic-payments/broadcaster-payments.md
[10]: #_7
