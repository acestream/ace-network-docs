# Premium Pool

Premium Pool - это сервис, позволяющий контент-провайдерам публиковать свой контент в Сети и подключаться к децентрализованному биллингу.

Основой сервиса является понятие премиум пул - это объединение одного либо более контент-провайдеров, которое характеризуется общими условиями биллинга. С технической точки зрения премиум пул - это сущность в блокчейне с такими свойствами:

- список владельцев пула
- настройки пула

Настройки пула могут быть изменены только путем голосования его владельцев.

## Пулы и правообладатели

Каждый премиум пул, ==кроме системного (NOTE: по факту это так, но стоит ли явно акцентировать?)==, обязан обладать правами на контент, который распространяется в рамках пула.
Это означает, что каждый бродкастер, входящий в пул, должен являться правообладателем всего контента, который он распространяет. Если сеть выявит нарушение этого правила, пул будет автоматически закрыт.

==С таким требованием нет смысла делать открытые пулы - убрать их из документации?==


## Пулы с токенами и без

В сети можно создавать пулы с токенами и без.

В пуле без токенов оплата доступа к контенту выполняется системными токенами.

Пул с токенами работает по такой схеме:

- к пулу привязан уникальный токен
- эмиссия фиксированного количества токенов пула выполняется в момент создания пула
- оплата доступа к контенту в рамках пула выполняется токенами пула

Пул с токенами обязан обеспечивать выкуп своих токенов на децентрализованной бирже.
Если сеть выявит нарушение этого правила, пул будет автоматически закрыт.


## Автоматический обмен токенов

Пользователи могут оплатить услуги премиум пула с токенами как токенами пула,
так и системные токенами. При оплате системными токенами выполняется [автоматический обмен][11].


## Создание пула

Создать пул может любой участник Сети. Для этого необходимо:

- заплатить Сети комиссию в 1000 XAT
- выбрать тип пула (открытый либо закрытый)
- определиться, будет ли это пул с токенами или без
- утвердить настройки пула

Если создается пул с токенами, то в момент создания выполняется эмиссия токенов для данного пула.
30% выпущенных токенов передаются в Сеть в виде комиссии.

Описанные действия выполняются операцией [Create Premium Pool][1]. В результате выполнения этой операции создается специальный аккаунт, который является представлением пула в блокчейне. Настройки пула хранятся в data entry этого аккаунта. Владельцами пула являются подписанты этого аккаунта.

Исключением является [Системный пул][2] - это открытый пул, владельцем которого является сама Сеть.


## Типы пулов

Есть два типа пулов - открытый и закрытый.

К открытому пулу может подключиться любой бродкастер без необходимости согласования с владельцами пула. Для этого необходимо указать в [транспортном файле][3] идентификатор пула (его публичный ключ).

Для подключения к закрытому пулу бродкастер должен быть добавлен в список участников. Сделать это могут только владельцы пула.

Тип пула указывается при его создании и не может быть изменен впоследствии.


## Системный пул

Системный пул - это открытый пул, вдалельцем которого является вся Сеть.

Настройки системного пула хранятся в системной настройке `system_premium_pool_settings`. Соответственно, изменять настройки системного пула можно путем [изменения системных настроек][4].

В отличие от обычных премиум пулов, настройки биллинга системного пула можно изменять.

Для оплаты доступа к контенту в рамках системного пула используются системные токены.


## Владельцы пула и участники пула

Владельцы пула - это аккаунты, у которых есть право изменять настройки пула, в том числе список владельцев и список участников (для закрытого пула). Владельцам пула изначательно принадлежат все токены, которые выпускаются в процессе создания пула (для пулов с токенами).

Владельцем системного пула является вся Сеть в целом.

Участники пула - это бродкастеры, подключенные к пулу. Для закрытых пулов - это список аккаунтов бродкастеров, хранящийся в настройках пула. Изменять список участников закрытого пула могут только владельцы пула. Участником открытого пула может стать любой бродкастер.


## Комиссия сети

В пулах с токенами комиссия сети распространяется только на эмисиию токенов - 30% от выпущенных токенов.
При оплате доступа в контенту в таких пулах комиссии нет.

В пулах без токенов комиссия сети составляет 30% от каждого платежа для оплаты доступа к контенту.


## Настройки пула

В настройках пула хранится такая информация:

- тип пула (открытый или закрытый)
- список бродкастеров (для закрытого пула)
- кто оплачивает трафик (бродкастеры либо пользователи)
- настройки распределения доходов
- настройки биллинга:
    - стоимость разового доступа
    - стоимость минуты для поминутной тарификации
    - стоимость и длительность подписки

Настройки биллинга позволяют включать либо выключать определенные типы биллинга, а также создавать несколько вариантов доступа (в зависимости от длительности). Например, можно запретить разовый доступ и поминутную тарификацию и сделать два варианта подписки: на 30 и на 360 дней.

Стоимость доступа может зависеть от страны, что тоже можно указать в настройках биллинга.

Тип пула и настройки биллинга указываются при создании пула и не могут быть изменены впоследствии. Если возникает необходимость изменить условия доступа к контенту, нужно создать новый премиум пул с новыми настройками.

Настройки биллинга применяются ко всему контенту, подключенному к пулу.


## Распределение доходов в пуле

Премиум пул получает доход в виде платежей за доступ к контенту. Этот доход распределяется между бродкастерами данного пула согласно правил биллинга, описанных ниже.

Также в настройках пула можно опционально указывать аккаунты, которые будут получать отчисления от всех платежей за доступ к контенту в рамках пула.

Пример:

```json
{
  "shareholders": [
    {
      "account_id": "GCXVRWMPOXVHW34Q4DUCFYGEKCOHCJ6SKBMHC63SRTNM3QMDZUZQOSL4",
      "share": 0.1
    },
    {
      "account_id": "GACJFCLDILCE5KT3UZ5KX2NRPHFNCUTYZYRIZRRAEAC5O3GYZKIISSNO",
      "share": 0.05
    }
  ]
}
```

В данном примере аккаунт `GCXV...OSL4` будет получать 10% от доходов, аккаунт `GACJ...SSNO` - 5%.
Оставшиеся 85% будут распределяться между бродкастерами.


## Биллинг

### Подписка

Подписка предоставляет доступ к контенту в рамках пула на фиксированный период времени (например, на 30 дней). Доступ по подписке ограничен временем просмотра - не более 1000 минут в месяц.

Покупка подписки осуществляется операцией [Buy Subscription][5].

Подписка активируется в момент покупки.

Распределение средств от оплаты подписок осуществляется в два этапа.
Комиссия сети (для пулов без своих токенов) и доля аккаунтов, которые получают отчисления согласно настройкам пула (если такие есть), распределяется в момент покупки подписки.
Доля бродкастеров распределяется системным смарт-контрактом [Distribute Subscriptions][6] после окончания срока действия подписки. Доля бродкастеров распределяется между бродкастерами, контент которых смотрел пользователь подписки за период ее действия, пропорционально времени просмотра. Детали алгоритма распределения смотрите в описании смарт-контракта.


### Поминутная тарификация

Предусматривает оплату за каждую минуту просмотра контента. Средства списываются со счета для оплаты сервисов пользователя, который смотрит контент. Распределение средств выполняется в момент оплаты. Доля бродкастера зачисляется на его счет в момент оплаты.

Списание и распределение средств осуществляется блокчейном второго уровня в рамках системы [учета трафика и времени][7].


### Разовый доступ

Предоставляет доступ к одной конкретной единице контента.

Логика работы разового доступа зависит от типа контента:

- VOD - доступ предоставляется навсегда
- Live - доступ предоставляется на фиксированное время (это время указано в настройках биллинга)

Покупка разового доступа осуществляется операцией [Buy Single Access][8]. Эта же операция выполняет распределение средств. Средства списываются со счета для оплаты сервисов пользователя, который смотрит контент. Распределение средств выполняется в момент оплаты. Доля бродкастера зачисляется на его счет в момент оплаты.

Разовый доступ активируется в момент покупки.


## Оплата трафика

В настройках премиум пула есть возможность выбора стороны, оплачивающей трафик: пользователь либо бродкастер.

Если трафик оплачивают пользователи, то расчеты за трафик выполняются по обычной схеме (точно так же, как для контента, не входящего в премиум пул).

Оплата трафика бродкастерами выполняется по такой схеме:

- весь трафик оплачивается со специального счета бродкастера
- узлы, потребляющие трафик, ничего не платят
- узлы, отдающие трафик, могут получить вознаграждение по системе "лотерея" (подробное описание [здесь][9])


## Контроль доступа к контенту

Контроль доступа полностью децентрализован и осуществляется узлами сети при обмене данными между собой. Каждый узел, участвующий в передаче данных по контенту из премиум пула, перед передачей данных другому узлу проверяет наличие у него доступа к данному контенту согласно настройкам пула.

[1]: ../list-of-operations/create-premium-pool.md
[2]: #_3
[3]: ../glossary/transport-file.md
[4]: ../glossary/system-settings.md
[5]: ../list-of-operations/buy-subscription.md
[6]: ../list-of-operations/distribute-subscriptions.md
[7]: ../get-started/traffic-time-accounting.md
[8]: ../list-of-operations/buy-single-access.md
[9]: ../traffic-payments/broadcaster-payments.md
[10]: #_7
[11]: ../system-tokens/exchange.md
