# Учет трафика и времени

==TODO: finalize==

- *профиль узла (токены, премиум-статус, подписка)*
- *проверка трат после чекпойнта (локальная база + gossip)*

    Как узнать, что узел ничего не потратил, начиная с чекпойнта? Спросить у пула историю транзакций узла. Суть защиты в том, что транзакции нельзя скрыть, поскольку они бродкастятся на случайный набор узлов в пуле. Скрыть можно только в случае, когда на момент запроса все узлы, которые хранят нужную информацию, недоступны. Это возможно, но атакующий не может это контролировать. Если такое случится, то возможна двойная трата, но она никогда не попадет в основной блокчейн (будет отбита валидаторами). Более того. Двойная трата может быть обнаружена, когда один из узлов с предыдущей историей станет доступен.

    Tribler's research on double spend detection: [https://github.com/Tribler/tribler/issues/4634](https://github.com/Tribler/tribler/issues/4634)

- *недетерминированность (возможны отклонение)*
- *влияние отклонений на взаиморасчеты (никто не теряет деньги)*
- *агрегация на втором уровне*
- *сводные транзакции на первом уровне*